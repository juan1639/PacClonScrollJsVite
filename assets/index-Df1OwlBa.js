(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const e of l)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(l){const e={};return l.integrity&&(e.integrity=l.integrity),l.referrerPolicy&&(e.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?e.credentials="include":l.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function n(l){if(l.ep)return;l.ep=!0;const e=a(l);fetch(l.href,e)}})();class F{constructor(o){this.constante={bsx:40,bsy:40,nro_filas:15,nro_columnas:19,nro_fantasmas:4,fps:60,pausa_preparado:5e3},this.resolucion=[this.constante.bsx*this.constante.nro_columnas,this.constante.bsy*this.constante.nro_filas],this.escala={x:o,y:o},this.array_laberinto=[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,5,1,1,1,1,1,1,1,9,1,1,1,1,1,1,1,5,9],[9,1,9,9,1,9,9,9,1,9,1,9,9,9,1,9,9,1,9],[9,1,9,9,1,9,9,9,1,9,1,9,9,9,1,9,9,1,9],[9,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,9],[9,1,9,9,1,9,1,9,9,9,9,9,1,9,1,9,9,1,9],[9,1,1,1,1,9,1,1,1,9,1,1,1,9,1,1,1,1,9],[9,9,9,9,1,9,9,9,1,9,1,9,9,9,1,9,9,9,9],[9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9],[9,1,9,9,1,9,1,9,1,9,1,9,1,9,1,9,9,1,9],[9,1,9,9,1,9,1,9,1,9,1,9,1,9,1,9,9,1,9],[0,1,1,1,1,9,1,1,1,1,1,1,1,9,1,1,1,1,0],[9,1,9,9,1,9,1,9,9,9,9,9,1,9,1,9,9,1,9],[9,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],this.canvas=document.getElementById("canvas"),this.ctx=canvas.getContext("2d"),this.objeto={laberinto:null,pacman:null,fantasma:[],array_puntitos:[],array_ptosGordos:[],fruta:null,animaPacman:!1,contPuntitosComidos:0},this.marcadores={puntos:0,nivel:1,vidas:3,scorePtos:document.getElementById("puntos"),scoreNivel:document.getElementById("nivel"),scoreVidas:document.getElementById("vidas"),botonNewGame:document.getElementById("boton__newGame"),contenedorControles:document.getElementById("contenedor2__botonesControl")},this.controles={izquierda:!1,derecha:!1,arriba:!1,abajo:!1},this.estado={actual:-1,gameover:!1,nivel_superado:!1,pausa_fantasmaComido:!1},this.estadoFantasmas={azules:!1,intermitentes:!1,duracionAzules:8e3,ptosComeFantasmas:100,ptosComeFruta:200},this.colores={paredColor:"#9D9D62",paredColorOscuro:"#808052",sueloColor:"#484848",rojo:"#D32111"},this.sonidos={preparado:new Audio("./audio/pacmaninicionivel.ogg"),game_over:new Audio("./audio/gameoveretro.ogg"),azules:new Audio("./audio/pacmanazules.ogg"),pacman_dies:new Audio("./audio/pacmandies.ogg"),eating_cherry:new Audio("./audio/pacmaneatingcherry.mp3"),eating_ghost:new Audio("./audio/pacmaneatinghost.ogg"),presentacion:new Audio("./audio/pacmanintermision.ogg"),sirena_fondo:new Audio("./audio/pacmansirena.ogg"),wakawaka:new Audio("./audio/pacmanwakawaka.mp3")}}}function Y(){for(let s=0;s<t.constante.nro_fantasmas;s++)m(t.objeto.fantasma[s],t.objeto.pacman,9)&&t.estado.actual==1&&(t.estadoFantasmas.azules?t.objeto.fantasma[s].comido||(r(t.sonidos.eating_ghost),t.objeto.fantasma[s].comido=!0,t.objeto.fantasma[s].showPtos=!0,t.estado.pausa_fantasmaComido=!0,t.escala.x===1&&t.escala.y===1?(t.objeto.fantasma[s].showX=t.objeto.fantasma[s].x,t.objeto.fantasma[s].showY=t.objeto.fantasma[s].y):(t.objeto.fantasma[s].showX=t.objeto.fantasma[s].escalar[0],t.objeto.fantasma[s].showY=t.objeto.fantasma[s].escalar[1]),t.estadoFantasmas.ptosComeFantasmas*=2,t.marcadores.puntos+=t.estadoFantasmas.ptosComeFantasmas,t.objeto.fantasma[s].showx2=t.estadoFantasmas.ptosComeFantasmas,setTimeout(()=>{t.objeto.fantasma[s].showPtos=!1},1200),setTimeout(()=>{t.estado.pausa_fantasmaComido=!1},500)):(t.estado.actual=2,t.estadoFantasmas.azules=!1,t.estadoFantasmas.ptosComeFantasmas=100,r(t.sonidos.pacman_dies),t.sonidos.pacman_dies.volume=.6,t.marcadores.vidas--,t.marcadores.scoreVidas.innerHTML=`Vidas: ${t.marcadores.vidas}`,t.marcadores.vidas>=0?setTimeout(()=>{t.estado.actual=1,t.objeto.pacman.revivirPacMan(),t.objeto.fantasma[0].revivirFantasmas(3,8,0,0),t.objeto.fantasma[1].revivirFantasmas(5,8,1,0),t.objeto.fantasma[2].revivirFantasmas(9,8,2,1),t.objeto.fantasma[3].revivirFantasmas(11,8,3,1)},3e3):(t.estado.actual=4,t.estado.gameover=!0,t.marcadores.vidas=0,t.marcadores.scoreVidas.innerHTML=`Vidas: ${t.marcadores.vidas}`,t.marcadores.botonNewGame.style.display="flex",t.sonidos.sirena_fondo.loop=!1,r(t.sonidos.game_over)))),t.objeto.fantasma[s].dibuja()}function S(){for(let s=0;s<t.objeto.array_puntitos.length;s++){let o=0;t.objeto.array_puntitos[s].visible&&t.estado.actual!=3&&(m(t.objeto.array_puntitos[s],t.objeto.pacman,o)&&(t.objeto.array_puntitos[s].visible=!1,t.objeto.contPuntitosComidos++,t.marcadores.puntos+=t.objeto.array_puntitos[s].sumaPtos,t.marcadores.scorePtos.innerHTML=`Puntos: ${t.marcadores.puntos}`,r(t.sonidos.wakawaka)),t.objeto.array_puntitos[s].dibuja()),s<4&&t.objeto.array_ptosGordos[s].visible&&t.estado.actual!=3&&(m(t.objeto.array_ptosGordos[s],t.objeto.pacman,o)&&(t.objeto.array_ptosGordos[s].visible=!1,t.objeto.contPuntitosComidos++,t.marcadores.puntos+=t.objeto.array_ptosGordos[s].sumaPtos,t.estadoFantasmas.azules=!0,r(t.sonidos.eating_ghost),r(t.sonidos.azules),t.sonidos.azules.loop=!0,setTimeout(()=>{t.estadoFantasmas.azules=!1,t.estadoFantasmas.intermitentes=!1,t.estadoFantasmas.ptosComeFantasmas=100,t.sonidos.azules.loop=!1,t.objeto.fantasma.forEach(a=>{a.comido=!1})},t.estadoFantasmas.duracionAzules),setTimeout(()=>{t.estadoFantasmas.intermitentes=!0},Math.floor(t.estadoFantasmas.duracionAzules/1.6))),t.objeto.array_ptosGordos[s].dibuja())}}function T(){m(t.objeto.fruta,t.objeto.pacman,5)&&t.estado.actual==1&&!t.objeto.fruta.comido&&(t.objeto.fruta.comido=!0,t.objeto.fruta.showPtos=!0,t.escala.x===1&&t.escala.y===1?(t.objeto.fruta.showX=t.objeto.fruta.x,t.objeto.fruta.showY=t.objeto.fruta.y):(t.objeto.fruta.showX=t.objeto.fruta.escalar[0],t.objeto.fruta.showY=t.objeto.fruta.escalar[1]),r(t.sonidos.eating_cherry),t.marcadores.puntos+=t.estadoFantasmas.ptosComeFruta,setTimeout(()=>{t.objeto.fruta.showPtos=!1,setTimeout(()=>{t.objeto.fruta.comido=!1,t.objeto.fruta.x=9*t.constante.bsx,t.objeto.fruta.y=11*t.constante.bsy},9e3)},2e3))}function d(s,o){let a,n;return t.objeto.pacman?(a=s-t.objeto.pacman.x,n=o-t.objeto.pacman.y,[t.objeto.pacman.escalaXY[0]+a,t.objeto.pacman.escalaXY[1]+n]):[0,0]}function m(s,o,a){return s.x+a<o.x+o.ancho-a&&s.x+s.ancho-a>o.x+a&&s.y+a<o.y+o.alto-a&&s.y+s.alto-a>o.y+a}function A(){let s=t.objeto.array_puntitos.length+t.objeto.array_ptosGordos.length;return t.objeto.contPuntitosComidos>=s}function I(){t.estado.nivel_superado&&(t.estado.nivel_superado=!1,t.marcadores.nivel++,t.marcadores.scoreNivel.innerHTML=`Nivel: ${t.marcadores.nivel}`,t.estadoFantasmas.ptosComeFruta*=2,t.objeto.fruta.comido=!1,t.estadoFantasmas.duracionAzules-=t.marcadores.nivel*1e3,t.objeto.contPuntitosComidos=0,t.estado.actual=3,t.sonidos.presentacion.play(),t.estadoFantasmas.duracionAzules<2e3&&(t.estadoFantasmas.duracionAzules=2e3),t.objeto.array_puntitos.forEach(s=>{s.visible=!0}),t.objeto.array_ptosGordos.forEach(s=>{s.visible=!0}),setTimeout(()=>{t.estado.actual=1,t.objeto.pacman.revivirPacMan(),t.objeto.fantasma[0].revivirFantasmas(3,8,0,0),t.objeto.fantasma[1].revivirFantasmas(5,8,1,0),t.objeto.fantasma[2].revivirFantasmas(9,8,2,1),t.objeto.fantasma[3].revivirFantasmas(11,8,3,1)},5e3))}function R(){if(t.estado.actual===0){const s=t.resolucion[0],o=t.resolucion[1];let a=120,n=Math.floor(s/5)+5,l=Math.floor(o/2),e=t.ctx.createLinearGradient(Math.floor(s/5),Math.floor(o/4),Math.floor(s/5)+5,Math.floor(o/1.5));e.addColorStop(0,"orangered"),e.addColorStop(1,"yellow"),t.escala.x===1&&t.escala.y===1?(a=120,n=Math.floor(s/5)+5,l=Math.floor(o/2)):(a=Math.floor(120/t.escala.x),n=Math.floor(s/(5*t.escala.x))+5,l=Math.floor(o/(2*t.escala.y)),e=t.ctx.createLinearGradient(n,Math.floor(l/2),n,Math.floor(o/(1.5*t.escala.y))),e.addColorStop(0,"orangered"),e.addColorStop(1,"yellow")),t.ctx.font=a.toString()+"px seriff",t.ctx.fillStyle=e,t.ctx.fillText("Preparado!",n,l)}if(t.estado.actual===3){const s=t.resolucion[0],o=t.resolucion[1];let a=100,n=Math.floor(s/9)+5,l=Math.floor(o/2);t.escala.x===1&&t.escala.y===1?a=100:(a=Math.floor(100/t.escala.x),n=Math.floor(s/(9*t.escala.x))+5,l=Math.floor(o/(2*t.escala.y))),t.ctx.font=a+"px seriff",t.ctx.fillStyle="lightgreen",t.ctx.fillText("Nivel Superado!",n,l)}t.objeto.fantasma.forEach(s=>{s.showPtos&&(t.ctx.save(),t.ctx.shadowColor="orange",t.ctx.shadowBlur=10,t.ctx.font="30px seriff",t.ctx.fillStyle="orangered",t.ctx.fillText(s.showx2,s.showX,s.showY),t.ctx.restore())}),t.objeto.fruta.showPtos&&(t.ctx.save(),t.ctx.shadowColor="orange",t.ctx.shadowBlur=10,t.ctx.font="32px seriff",t.ctx.fillStyle="orangered",t.ctx.fillText(t.estadoFantasmas.ptosComeFruta,t.objeto.fruta.showX,t.objeto.fruta.showY),t.ctx.restore())}function w(){t.estado.actual=0,t.estado.gameover=!1,t.marcadores.puntos=0,t.marcadores.scorePtos.innerHTML=`Puntos: ${t.marcadores.puntos}`,t.marcadores.nivel=1,t.marcadores.scoreNivel.innerHTML=`Nivel: ${t.marcadores.nivel}`,t.marcadores.vidas=3,t.marcadores.scoreVidas.innerHTML=`Vidas: ${t.marcadores.vidas}`,t.estadoFantasmas.ptosComeFruta=200,t.objeto.fruta.comido=!1,t.estadoFantasmas.duracionAzules=8e3,t.estado.nivel_superado=!1,t.objeto.contPuntitosComidos=0,t.objeto.array_puntitos.forEach(s=>{s.visible=!0}),t.objeto.array_ptosGordos.forEach(s=>{s.visible=!0}),t.objeto.pacman.revivirPacMan(),t.objeto.fantasma[0].revivirFantasmas(3,8,0,0),t.objeto.fantasma[1].revivirFantasmas(5,8,1,0),t.objeto.fantasma[2].revivirFantasmas(9,8,2,1),t.objeto.fantasma[3].revivirFantasmas(11,8,3,1)}function z(){if(!t.estado.gameover)return;const s=t.resolucion[0],o=t.resolucion[1];let a=100,n=Math.floor(s/5)+5,l=Math.floor(o/2);t.escala.x===1&&t.escala.y===1?a=100:(a=Math.floor(100/t.escala.x),n=Math.floor(s/(5*t.escala.x))+5,l=Math.floor(o/(2*t.escala.y))),t.ctx.font=a.toString()+"px seriff",t.ctx.fillStyle="orange",t.ctx.fillText("Game Over",n,l)}function G(){const s=t.resolucion[0],o=t.resolucion[1];let a=120,n=30,l=Math.floor(s/5)+5,e=Math.floor(o/2),i=Math.floor(s/9)+5,c=o-t.constante.bsy*2;t.escala.x===1&&t.escala.y===1?(a=120,n=30,l=Math.floor(s/5)+5,e=Math.floor(o/2),i=Math.floor(s/9)+5,c=o-t.constante.bsy*2):(a=Math.floor(120/t.escala.x),n=Math.floor(30/t.escala.x),l=Math.floor(s/(5*t.escala.x))+5,e=Math.floor(o/(2*t.escala.y)),i=Math.floor(s/(9*t.escala.x))+5,c=Math.floor(o/(t.escala.y-.5))-t.constante.bsy*2*t.escala.y),t.ctx.font=a.toString()+"px seriff",t.ctx.fillStyle="orangered",t.ctx.fillText("Pac Clon",l,e),t.ctx.font=n.toString()+"px seriff",t.ctx.fillStyle="white",t.ctx.fillText("Pulse INTRO o Nueva Partida para comenzar...",i,c),t.objeto.pacman.secuenciaPresentacion(),t.objeto.fantasma[1].secuenciaPresentacion()}function r(s){s.play()}function b(s,o,a){s.play(),s.loop=o,s.volume=a}function E(){t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(0,0,t.canvas.width,t.canvas.height)}class M{constructor(o){this.array=o,this.altoM=this.array.length,this.anchoM=this.array[0].length,this.anchoT=t.constante.bsx,this.altoT=t.constante.bsy}colision(o,a){return this.array[a][o]==9}tile(o,a){let n=Math.floor(o/this.anchoT),l=Math.floor(a/this.altoT);return this.array[l][n]}dibuja(){if(t.escala.x===1&&t.escala.y===1){for(let o=0;o<this.altoM;o++)for(let a=0;a<this.anchoM;a++)if(this.array[o][a]==9){let n=a*this.anchoT+0,l=o*this.altoT+0;t.ctx.fillStyle=t.colores.paredColor,t.ctx.fillRect(n,l,this.anchoT-2,this.altoT-2),t.ctx.fillStyle=t.colores.paredColorOscuro,t.ctx.fillRect(n+2,l+2,this.anchoT-3,this.altoT-3)}}else for(let o=0;o<this.altoM;o++)for(let a=0;a<this.anchoM;a++)if(this.array[o][a]===9){let n=t.constante.bsx;n=n*2;const l=t.resolucion;let e=a*this.anchoT+0,i=o*this.altoT+0,c=d(e,i);(c[0]>-n&&c[0]<=l[0]||c[1]>-n&&c[1]<=l[1])&&(t.ctx.fillStyle=t.colores.paredColor,t.ctx.fillRect(c[0]+2,c[1]+2,this.anchoT-2,this.altoT-2),t.ctx.fillStyle=t.colores.paredColorOscuro,t.ctx.fillRect(c[0]+3,c[1]+3,this.anchoT-4,this.altoT-4))}}static dibuja_mapa(o){for(let a=0;a<t.constante.nro_filas;a++)for(let n=0;n<t.constante.nro_columnas;n++)if(t.array_laberinto[a][n]===9){const l=Math.floor(t.resolucion[0]/t.escala.x)-t.constante.nro_columnas*o;t.ctx.fillStyle="green",t.ctx.fillRect(n*o+l,a*o,o,o)}}static calcula_sizeMapa(){return t.escala.x===4&&t.escala.y===4?3:t.escala.x===3&&t.escala.y===3?4:t.escala.x===2&&t.escala.y===2?6:1}}class L{constructor(o,a){this.x=o*t.constante.bsx+Math.floor(t.constante.bsx/2),this.y=a*t.constante.bsy+Math.floor(t.constante.bsy/2),this.left=o*t.constante.bsx,this.top=a*t.constante.bsy,this.radio=4,this.ancho=this.radio*2,this.alto=this.radio*2,this.color="white",this.visible=!0,this.sumaPtos=10}dibuja(){let o=[];if(t.ctx.beginPath(),t.escala.x===1&&t.escala.y===1)t.ctx.arc(this.x,this.y,this.radio,0,Math.PI*2);else{o=d(this.left,this.top),o[0]+=Math.floor(t.constante.bsx/2),o[1]+=Math.floor(t.constante.bsy/2);let a=t.constante.bsx;a=a*2;const n=t.resolucion;(o[0]>-a&&o[0]<=n[0]||o[1]>-a&&o[1]<=n[1])&&t.ctx.arc(o[0],o[1],this.radio,0,Math.PI*2)}t.ctx.fillStyle=this.color,t.ctx.fill(),t.ctx.closePath()}}class N{constructor(o,a){this.x=o*t.constante.bsx+Math.floor(t.constante.bsx/2),this.y=a*t.constante.bsy+Math.floor(t.constante.bsy/2),this.left=o*t.constante.bsx,this.top=a*t.constante.bsy,this.radio=4,this.ancho=this.radio*2,this.alto=this.radio*2,this.color="lightblue",this.visible=!0,this.sumaPtos=50}dibuja(){let o=[];this.radio+=.4,this.radio>=15&&(this.radio=4),t.ctx.save(),t.ctx.beginPath(),t.ctx.shadowColor=this.color,t.ctx.shadowBlur=20,t.escala.x===1&&t.escala.y===1?t.ctx.arc(this.x,this.y,Math.floor(this.radio),0,Math.PI*2):(o=d(this.left,this.top),o[0]+=Math.floor(t.constante.bsx/2),o[1]+=Math.floor(t.constante.bsy/2),t.ctx.arc(o[0],o[1],this.radio,0,Math.PI*2)),t.ctx.fillStyle=this.color,t.ctx.fill(),t.ctx.closePath(),t.ctx.restore()}}function x(s,o,a,n){let l=2,e;t.estado.actual!==1?e="rgb(245, 225, 9)":(e=t.ctx.createRadialGradient(s+a,o+a,10,s+a,o+a,a),e.addColorStop(0,"#FA1"),e.addColorStop(1,"#FE1")),t.ctx.beginPath(),t.ctx.arc(s+a+l,o+a+l,a,0,Math.PI*2),t.ctx.fillStyle=e,t.ctx.fill(),t.ctx.closePath()}function p(s,o,a,n,l){let e=2;if(l)for(let i=0;i<18;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e+i,o+a+e+i,parseInt(t.constante.bsx/2)-i,1),t.ctx.fillRect(s+a+e+i,o+a+e-i,parseInt(t.constante.bsx/2)-i,1);else for(let i=0;i<10;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e+i*2,o+a+e+i,parseInt(t.constante.bsx/2)-i*2,1),t.ctx.fillRect(s+a+e+i*2,o+a+e-i,parseInt(t.constante.bsx/2)-i*2,1)}function y(s,o,a,n,l){let e=2;if(l)for(let i=0;i<18;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e-i,o+a+e+i,-(parseInt(t.constante.bsx/2)-i),1),t.ctx.fillRect(s+a+e-i,o+a+e-i,-(parseInt(t.constante.bsx/2)-i),1);else for(let i=0;i<10;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e-i*2,o+a+e+i,-(parseInt(t.constante.bsx/2)-i*2),1),t.ctx.fillRect(s+a+e-i*2,o+a+e-i,-(parseInt(t.constante.bsx/2)-i*2),1)}function v(s,o,a,n,l){let e=2;if(l)for(let i=0;i<18;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e+i,o+a+e+i,1,parseInt(t.constante.bsx/2)-i),t.ctx.fillRect(s+a+e-i,o+a+e+i,1,parseInt(t.constante.bsx/2)-i);else for(let i=0;i<10;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e+i,o+a+e+i*2,1,parseInt(t.constante.bsx/2)-i*2),t.ctx.fillRect(s+a+e-i,o+a+e+i*2,1,parseInt(t.constante.bsx/2)-i*2)}function _(s,o,a,n,l){let e=2;if(l)for(let i=0;i<18;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e+i,o+a+e-i,1,-(parseInt(t.constante.bsx/2)-i)),t.ctx.fillRect(s+a+e-i,o+a+e-i,1,-(parseInt(t.constante.bsx/2)-i));else for(let i=0;i<10;i++)t.ctx.fillStyle=t.colores.sueloColor,t.ctx.fillRect(s+a+e+i,o+a+e-i*2,1,-(parseInt(t.constante.bsx/2)-i*2)),t.ctx.fillRect(s+a+e-i,o+a+e-i*2,1,-(parseInt(t.constante.bsx/2)-i*2))}function g(s,o,a,n,l){let e=2,i=15;n=n[0],t.estadoFantasmas.azules&&!t.estadoFantasmas.intermitentes?n="royalblue":t.estadoFantasmas.azules&&!t.objeto.animaPacMan&&t.estadoFantasmas.intermitentes?n="lightblue":t.estadoFantasmas.azules&&t.objeto.animaPacMan&&t.estadoFantasmas.intermitentes&&(n="royalblue"),t.estado.actual==-1&&t.objeto.pacman.velX>0&&(n="royalblue"),l||(t.ctx.beginPath(),t.ctx.arc(s+a+e,o+a+e,a,Math.PI,0),t.ctx.fillStyle=n,t.ctx.fill(),t.ctx.closePath(),t.ctx.fillStyle=n,t.ctx.fillRect(s+e,o+a+e,a*2,parseInt(a))),t.ctx.beginPath(),t.ctx.arc(s+a+e-8,o+i,6,0,Math.PI*2),t.ctx.fillStyle="white",t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(s+a+e+8,o+i,6,0,Math.PI*2),t.ctx.fillStyle="white",t.ctx.fill(),t.ctx.closePath()}function P(s,o,a,n,l,e){let i=2,c=14;t.ctx.beginPath(),t.ctx.arc(s+a+i-n,o+c+e,3,0,Math.PI*2),t.ctx.fillStyle="black",t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(s+a+i+l,o+c+e,3,0,Math.PI*2),t.ctx.fillStyle="black",t.ctx.fill(),t.ctx.closePath()}function k(s,o,a,n,l){let e=2,i=11;const c=t.ctx.createRadialGradient(n+a+e-6,l+a+e+4,3,n+a+e-6,l+a+e+4,a);c.addColorStop(0,t.colores.rojo),c.addColorStop(1,"#F52"),t.ctx.beginPath(),t.ctx.moveTo(s+a+e-6,o+a+e+4),t.ctx.lineTo(s+a,o),t.ctx.lineTo(s+a+e+3,o+a),t.ctx.strokeStyle="seagreen",t.ctx.stroke(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(s+a+e+3,o+a+e+4,i,0,Math.PI*2),t.ctx.fillStyle=t.colores.rojo,t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(s+a+e-6,o+a+e+4,i,0,Math.PI*2),t.ctx.fillStyle=c,t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(s+a+e-6,o+a+e+4,i+1,Math.PI*1.5,Math.PI/2),t.ctx.strokeStyle=t.colores.sueloColor,t.ctx.stroke(),t.ctx.closePath()}class O{constructor(){this.x=9*t.constante.bsx,this.y=11*t.constante.bsy,this.escalar=[],this.direccion=0,this.ancho=t.constante.bsx,this.alto=t.constante.bsy,this.radio=parseInt(t.constante.bsx/2),this.color="red",this.comido=!1,this.showPtos=!1,this.showX=0,this.showY=0,this.hacia_donde=["231","230","013","012"],this.hacia_donde_velXY=[[-1,0,0,0,7,12],[1,0,1,0,1,6],[0,-1,0,0,13,18],[0,1,0,1,7,12]],this.ptosClave=[[4,1],[14,1],[4,4],[6,4],[12,4],[14,4],[4,8],[6,8],[12,8],[14,8],[1,11],[4,11],[6,11],[12,11],[14,11],[17,11],[4,13],[6,13],[12,13],[14,13]],this.velX=1,this.velY=0,this.sumarAncho=1,this.sumarAlto=0}actualiza(){let o=0,a=0;for(let n=0;n<this.ptosClave.length;n++){let l=this.ptosClave[n][0]*t.constante.bsx,e=this.ptosClave[n][1]*t.constante.bsy;this.x==l&&this.y==e&&Math.floor(Math.random()*10)<5&&(this.elegir_otra_direccion(),this.nuevos_valores())}o=parseInt((this.x+this.velX+this.ancho*this.sumarAncho)/t.constante.bsx),a=parseInt((this.y+this.velY+this.alto*this.sumarAlto)/t.constante.bsy),t.objeto.laberinto.colision(o,a)?(this.elegir_otra_direccion(),this.nuevos_valores()):(this.x+=this.velX*2,this.y+=this.velY*2,this.x>t.constante.nro_columnas*t.constante.bsx&&this.velX>0&&(this.x=-t.constante.bsx),this.x<-t.constante.bsx&&this.velX<0&&(this.x=t.constante.nro_columnas*t.constante.bsx))}dibuja(){let o=this.x,a=this.y;t.estado.actual==1&&this.actualiza(),(t.escala.x!==1||t.escala.y!==1)&&(this.escalar=d(this.x,this.y),o=this.escalar[0],a=this.escalar[1]),this.comido||k(o,a,this.radio,this.x,this.y)}elegir_otra_direccion(){let o=this.hacia_donde[this.direccion],a=Math.floor(Math.random()*3),n=o.charAt(a);this.direccion=parseInt(n)}nuevos_valores(){this.velX=this.hacia_donde_velXY[this.direccion][0],this.velY=this.hacia_donde_velXY[this.direccion][1],this.sumarAncho=this.hacia_donde_velXY[this.direccion][2],this.sumarAlto=this.hacia_donde_velXY[this.direccion][3]}}class X{constructor(){this.x=9*t.constante.bsx,this.y=1*t.constante.bsy,this.ancho=t.constante.bsx,this.alto=t.constante.bsy,this.radio=Math.floor(t.constante.bsy/2),this.escalaXY=[],this.color="yellow",this.direccion={ri:[1,0,1,0,1,6],le:[-1,0,0,0,7,12],up:[0,-1,0,0,13,18],do:[0,1,0,1,19,24]},this.pulsada="ri",this.orientacion=this.pulsada,this.diesAnima=0,this.velX=1,this.velY=0,this.sumarAncho=1,this.sumarAlto=0}dibuja(){let o=this.x,a=this.y;if(t.estado.actual===2){this.pacManDies();return}t.estado.actual===1&&!t.estado.pausa_fantasmaComido&&this.actualiza(),t.escala.x===1&&t.escala.y===1||(this.escalaXY=this.dibuja_escala(),o=this.escalaXY[0],a=this.escalaXY[1]),x(o,a,this.radio,this.color),this.velX==1?p(o,a,this.radio,this.color,t.objeto.animaPacMan):this.velX==-1?y(o,a,this.radio,this.color,t.objeto.animaPacMan):this.velY==1?v(o,a,this.radio,this.color,t.objeto.animaPacMan):this.velY==-1&&_(o,a,this.radio,this.color,t.objeto.animaPacMan),this.tapar_escapatorias()}dibuja_escala(){let o=Math.floor(t.resolucion[0]/2),a=Math.floor(t.resolucion[1]/2);return o/=t.escala.x,a/=t.escala.y,[o-this.radio,a-this.radio]}actualiza(){t.controles.izquierda?this.pulsada="le":t.controles.derecha?this.pulsada="ri":t.controles.arriba?this.pulsada="up":t.controles.abajo&&(this.pulsada="do");let o=0,a=0;this.x%t.constante.bsx==0&&this.y%t.constante.bsy==0&&(o=Math.floor(this.x/t.constante.bsx)+this.direccion[this.pulsada][0],a=Math.floor(this.y/t.constante.bsy)+this.direccion[this.pulsada][1],t.objeto.laberinto.colision(o,a)||(this.velX=this.direccion[this.pulsada][0],this.velY=this.direccion[this.pulsada][1],this.sumarAncho=this.direccion[this.pulsada][2],this.sumarAlto=this.direccion[this.pulsada][3],this.orientacion=this.pulsada)),o=Math.floor((this.x+this.velX+this.ancho*this.sumarAncho)/t.constante.bsx),a=Math.floor((this.y+this.velY+this.alto*this.sumarAlto)/t.constante.bsy),t.objeto.laberinto.colision(o,a)||(this.x+=this.velX*2,this.y+=this.velY*2,this.x>t.constante.nro_columnas*t.constante.bsx&&this.velX>0&&(this.x=-t.constante.bsx),this.x<-t.constante.bsx&&this.velX<0&&(this.x=t.constante.nro_columnas*t.constante.bsx))}pacManDies(){let o=this.x,a=this.y;t.escala.x===1&&t.escala.y===1||(this.escalaXY=this.dibuja_escala(),o=this.escalaXY[0],a=this.escalaXY[1]),x(o,a,this.radio,this.color),this.diesAnima===0?p(o,a,this.radio,this.color,t.objeto.animaPacMan):this.diesAnima===2?y(o,a,this.radio,this.color,t.objeto.animaPacMan):this.diesAnima===1?v(o,a,this.radio,this.color,t.objeto.animaPacMan):this.diesAnima===3&&_(o,a,this.radio,this.color,t.objeto.animaPacMan)}revivirPacMan(){this.x=9*t.constante.bsx,this.y=4*t.constante.bsy,this.pulsada="ri",this.velX=1,this.velY=0,this.sumarAncho=1,this.sumarAlto=0}secuenciaPresentacion(){const o=-(t.constante.bsx*5);let a=this.x,n=this.y;this.x=this.x+this.velX*t.escala.x,(this.x>t.resolucion[0]&&this.velX>0||this.x<o&&this.velX<0)&&(this.velX=-this.velX),(t.escala.x!==1||t.escala.y!==1)&&(this.escalaXY=this.escalar_pacmanDinamico(this.x,this.y),a=this.escalaXY[0],n=this.escalaXY[1]),x(a,n,this.radio,this.color),this.velX==1?p(a,n,this.radio,this.color,t.objeto.animaPacMan):this.velX==-1?y(a,n,this.radio,this.color,t.objeto.animaPacMan):this.velY==1?v(a,n,this.radio,this.color,t.objeto.animaPacMan):this.velY==-1&&_(a,n,this.radio,this.color,t.objeto.animaPacMan)}escalar_pacmanDinamico(o,a){return[Math.floor(o/t.escala.x),Math.floor(a/t.escala.y)]}valoresIniciales(){this.x=9*t.constante.bsx,this.velX=1}tapar_escapatorias(){let o=-1*t.constante.bsx,a=11*t.constante.bsy,n=19*t.constante.bsx,l=11*t.constante.bsy;if(t.ctx.fillStyle=t.colores.sueloColor,t.escala.x===1&&t.escala.y===1)t.ctx.fillRect(o,a,t.constante.bsx,t.constante.bsy),t.ctx.fillRect(n,l,t.constante.bsx,t.constante.bsy);else{let e=d(o,a),i=d(n,l);t.ctx.fillRect(e[0],e[1],t.constante.bsx+2,t.constante.bsy+2),t.ctx.fillRect(i[0],i[1],t.constante.bsx+2,t.constante.bsy+2)}}static dibuja_mapa(o,a,n){const l=Math.floor(a/t.constante.bsx),e=Math.floor(n/t.constante.bsy),i=Math.floor(t.resolucion[0]/t.escala.x)-t.constante.nro_columnas*o;t.ctx.fillStyle="rgb(255, 255, 150)",t.ctx.fillRect(l*o+i,e*o,o,o)}}class f{constructor(o,a,n,l){this.tipoF=n,this.direccion=l,this.ancho=t.constante.bsx,this.alto=t.constante.bsy,this.radio=Math.floor(t.constante.bsy/2.2),this.listaColores=[["pink","#E7C"],[t.colores.rojo,"#F42"],["orange","#FC0"],["seagreen","#1B4"]],this.color=this.listaColores[this.tipoF],this.comido=!1,this.showPtos=!1,this.showX=0,this.showY=0,this.showx2=0,this.hacia_donde=["231","230","013","012"],this.hacia_donde_velXY=[[-1,0,0,0,7,12],[1,0,1,0,1,6],[0,-1,0,0,13,18],[0,1,0,1,7,12]],this.ptosClave=[[4,1],[14,1],[4,4],[6,4],[12,4],[14,4],[4,8],[6,8],[12,8],[14,8],[1,11],[4,11],[6,11],[12,11],[14,11],[17,11],[4,13],[6,13],[12,13],[14,13]],this.x=o,this.y=a,this.escalar=[],this.velX=this.hacia_donde_velXY[this.direccion][0],this.velY=this.hacia_donde_velXY[this.direccion][1],this.sumarAncho=this.hacia_donde_velXY[this.direccion][2],this.sumarAlto=this.hacia_donde_velXY[this.direccion][3]}actualiza(){let o=0,a=0;for(let n=0;n<this.ptosClave.length;n++){let l=this.ptosClave[n][0]*t.constante.bsx,e=this.ptosClave[n][1]*t.constante.bsy;this.x==l&&this.y==e&&Math.floor(Math.random()*10)<7+t.marcadores.nivel&&(this.fantasma_persigue(),this.nuevos_valores())}o=parseInt((this.x+this.velX+this.ancho*this.sumarAncho)/t.constante.bsx),a=parseInt((this.y+this.velY+this.alto*this.sumarAlto)/t.constante.bsy),t.objeto.laberinto.colision(o,a)?(Math.floor(Math.random()*10)<5+t.marcadores.nivel?this.fantasma_persigue():this.elegir_otra_direccion(),this.nuevos_valores()):(this.x+=this.velX*2,this.y+=this.velY*2,this.x>t.constante.nro_columnas*t.constante.bsx&&this.velX>0&&(this.x=-t.constante.bsx),this.x<-t.constante.bsx&&this.velX<0&&(this.x=t.constante.nro_columnas*t.constante.bsx))}dibuja(){let o=this.x,a=this.y,n=0,l=0,e=0;t.estado.actual===1&&!t.estado.pausa_fantasmaComido&&this.actualiza(),(t.escala.x!==1||t.escala.y!==1)&&(this.escalar=d(this.x,this.y),o=this.escalar[0],a=this.escalar[1]),g(o,a,this.radio,this.color,this.comido),this.velX==1?(n=5,l=11,e=0):this.velX==-1?(n=11,l=4,e=0):this.velY==-1?(n=8,l=8,e=-2):this.velY==1&&(n=8,l=8,e=4),P(o,a,this.radio,n,l,e)}elegir_otra_direccion(){let o=this.hacia_donde[this.direccion],a=Math.floor(Math.random()*3),n=o.charAt(a);this.direccion=parseInt(n)}nuevos_valores(){this.velX=this.hacia_donde_velXY[this.direccion][0],this.velY=this.hacia_donde_velXY[this.direccion][1],this.sumarAncho=this.hacia_donde_velXY[this.direccion][2],this.sumarAlto=this.hacia_donde_velXY[this.direccion][3]}fantasma_persigue(){Math.floor(Math.random()*10)<5?this.y<t.objeto.pacman.y?this.direccion=3:this.direccion=2:this.x<t.objeto.pacman.x?this.direccion=1:this.direccion=0}revivirFantasmas(o,a,n,l){this.tipoF=n,this.direccion=l,this.x=o*t.constante.bsx,this.y=a*t.constante.bsy,this.velX=this.hacia_donde_velXY[this.direccion][0],this.velY=this.hacia_donde_velXY[this.direccion][1],this.sumarAncho=this.hacia_donde_velXY[this.direccion][2],this.sumarAlto=this.hacia_donde_velXY[this.direccion][3]}secuenciaPresentacion(){let o=0,a=0,n=0,l=t.objeto.pacman.escalaXY[0],e=t.objeto.pacman.escalaXY[1];const i=Math.floor(t.constante.bsx*1.3);t.escala.x===1&&t.escala.y===1&&(l=t.objeto.pacman.x,e=t.objeto.pacman.y),g(l+i,e,this.radio,this.color,this.comido),t.objeto.pacman.velX==1?(o=5,a=11):t.objeto.pacman.velX==-1&&(o=11,a=4),P(l+i,e,this.radio,o,a,n)}static dibuja_mapa(o,a,n,l){const e=[["pink","#E7C"],[t.colores.rojo,"#F42"],["orange","#FC0"],["seagreen","#1B4"]],i=Math.floor(a/t.constante.bsx),c=Math.floor(n/t.constante.bsy),C=Math.floor(t.resolucion[0]/t.escala.x)-t.constante.nro_columnas*o;t.ctx.fillStyle=e[l][0],t.ctx.fillRect(i*o+C,c*o,o,o)}}function h(){t.controles.izquierda=!1,t.controles.derecha=!1,t.controles.arriba=!1,t.controles.abajo=!1}document.addEventListener("keydown",s=>{const o=s.key;console.log("Tecla: ",o),o==="ArrowUp"?(h(),t.controles.arriba=!0):o==="ArrowDown"&&(h(),t.controles.abajo=!0),o==="ArrowLeft"&&(h(),t.controles.izquierda=!0),o==="ArrowRight"&&(h(),t.controles.derecha=!0),o==="Enter"&&(t.estado.actual==-1?(t.estado.actual=0,t.marcadores.botonNewGame.style.display="none",t.objeto.pacman.y=4*t.constante.bsy,r(t.sonidos.preparado),t.objeto.pacman.valoresIniciales(),setTimeout(()=>{t.estado.actual==0&&(t.estado.actual=1),b(t.sonidos.sirena_fondo,!0,.1)},t.constante.pausa_preparado)):t.estado.gameover&&(t.marcadores.botonNewGame.style.display="none",r(t.sonidos.preparado),w(),setTimeout(()=>{t.estado.actual=1,b(t.sonidos.sirena_fondo,!0,.1)},t.constante.pausa_preparado)))});document.addEventListener("click",s=>{s.target.id==="boton__newGame"&&(t.estado.actual===-1?(t.estado.actual=0,t.marcadores.botonNewGame.style.display="none",t.objeto.pacman.y=4*t.constante.bsy,r(t.sonidos.preparado),t.objeto.pacman.valoresIniciales(),setTimeout(()=>{t.estado.actual==0&&(t.estado.actual=1),b(t.sonidos.sirena_fondo,!0,.1)},t.constante.pausa_preparado)):t.estado.gameover&&(t.marcadores.botonNewGame.style.display="none",r(t.sonidos.preparado),w(),setTimeout(()=>{t.estado.actual=1,b(t.sonidos.sirena_fondo,!0,.1)},t.constante.pausa_preparado))),s.target.id==="boton__le"||s.target.parentElement.id==="boton__le"?(h(),t.controles.izquierda=!0):s.target.id==="boton__ri"||s.target.parentElement.id==="boton__ri"?(h(),t.controles.derecha=!0):s.target.id==="boton__up"||s.target.parentElement.id==="boton__up"?(h(),t.controles.arriba=!0):(s.target.id==="boton__do"||s.target.parentElement.id==="boton__do")&&(h(),t.controles.abajo=!0)});const D=[1,2,3,4];let j=0,t,u;window.onload=()=>{for(;!D.includes(j);)j=parseInt(prompt("Seleciona el Zoom (1, 2, 3, 4)"));t=new F(j),t.canvas.width=t.resolucion[0],t.canvas.height=t.resolucion[1]-t.constante.bsy,t.ctx.scale(t.escala.x,t.escala.y),u=M.calcula_sizeMapa(),t.objeto.laberinto=new M(t.array_laberinto);let s;for(let o=0;o<t.array_laberinto.length;o++)for(let a=0;a<t.array_laberinto[0].length;a++)t.array_laberinto[o][a]==1&&(s=new L(a,o),t.objeto.array_puntitos.push(s)),t.array_laberinto[o][a]==5&&(s=new N(a,o),t.objeto.array_ptosGordos.push(s));t.objeto.fruta=new O,t.objeto.pacman=new X,t.objeto.fantasma[0]=new f(3*t.constante.bsx,8*t.constante.bsy,0,0),t.objeto.fantasma[1]=new f(5*t.constante.bsx,8*t.constante.bsy,1,0),t.objeto.fantasma[2]=new f(9*t.constante.bsx,8*t.constante.bsy,2,1),t.objeto.fantasma[3]=new f(11*t.constante.bsx,8*t.constante.bsy,3,1),setInterval(function(){B()},1e3/t.constante.fps),setInterval(function(){t.objeto.animaPacMan?t.objeto.animaPacMan=!1:t.objeto.animaPacMan=!0,t.objeto.pacman.diesAnima++,t.objeto.pacman.diesAnima>3&&(t.objeto.pacman.diesAnima=0)},150),setInterval(function(){t.estado.actual!=0&&(t.estado.nivel_superado=A())},200)};function B(){if(E(),t.estado.actual==-1&&G(),t.estado.actual!=-1){t.objeto.laberinto.dibuja(),S(),t.objeto.fruta.dibuja(),t.objeto.pacman.dibuja(),Y(),M.dibuja_mapa(u),t.objeto.pacman&&X.dibuja_mapa(u,t.objeto.pacman.x,t.objeto.pacman.y);for(let s of t.objeto.fantasma)s&&f.dibuja_mapa(u,s.x,s.y,s.tipoF);T(),I(),z(),R()}}
